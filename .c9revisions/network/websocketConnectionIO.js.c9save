{"ts":1361913179831,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1361913227070,"patch":[[{"diffs":[[1,"/**\r\n * @author      SÃ©bastien Bolduc    <sebastien.bolduc@gmail.com>\r\n * @version     0.0                 (current version number of program)\r\n * @since       2013-02-26          (the version of the package this class was first added to)\r\n */\r\n\r\n// create global namespace\r\nwindow.WAF = window.WAF || {};\r\nwindow.WAF.network = window.WAF.network || {};\r\n\r\n// using IIFE (Immediately-Invoked Function Expression) to give each file its own local scope\r\n(function(namespace, undefined) {\r\n    // public methods and properties\r\n    /**\r\n     * Constructor.\r\n     * \r\n     * @param\r\n     * @return \r\n     */\r\n    namespace.WebSocketConnection = function() {\r\n        this.connection = null;\r\n        this.onOpenFunction = null;\r\n        this.onCloseFunction = null;\r\n        this.onMessageFunction = null;\r\n        this.onErrorFunction = null;\r\n    };\r\n    \r\n    // private methods and properties\r\n    var network = window.WAF.network;\r\n    \r\n}(window.WAF.network = window.WAF.network || {}));"]],"start1":0,"start2":0,"length1":0,"length2":989}]],"length":989,"saved":false}
{"ts":1361914667039,"patch":[[{"diffs":[[0," || {};\r"],[1,"\nwindow.WAF.io = io;                                 // define by Node.js\r"],[0,"\n\r\n// us"]],"start1":346,"start2":346,"length1":16,"length2":90},{"diffs":[[0,"nnection"],[1,"IO"],[0," = funct"]],"start1":704,"start2":704,"length1":16,"length2":18},{"diffs":[[0,"nction = null;\r\n"],[-1,""],[0,"        this.onE"]],"start1":863,"start2":863,"length1":32,"length2":32},{"diffs":[[0,"\r\n    \r\n"],[1,"    /**\r\n     * Tell if a WebSocket connection is activated.\r\n     * \r\n     * @param\r\n     * @return True of False depending on the state of the connection.\r\n     */\r\n    namespace.WebSocketConnectionIO.prototype.isOpen = function() {\r\n        if (!this.connection) {\r\n            return false;\r\n        } else if (this.connection.disconnected) {\r\n            return false;\r\n        }\r\n        \r\n        return true;\r\n    };\r\n    \r\n    /**\r\n     * Open a WebSockect connection.\r\n     * \r\n     * @param url Url of the server to connect to.\r\n     * @return\r\n     */\r\n    namespace.WebSocketConnectionIO.prototype.open = function(url) {\r\n        if (this.connection === null) {\r\n            this.connection = window.WAF.io.connect(null,{'auto connect': false}); \r\n        }\r\n        \r\n        this.setOnOpen();\r\n        this.setOnClose();\r\n        this.setOnMessage();\r\n    };\r\n    \r\n    /**\r\n     * Close a WebSocket connection.\r\n     * \r\n     * @param\r\n     * @return\r\n     */\r\n    namespace.WebSocketConnection.prototype.close = function() {\r\n        this.connection.disconnected;\r\n    };\r\n    \r\n    /**\r\n     * Send data via a WebSocket connection.\r\n     * \r\n     * @param data Data to be send.\r\n     * @return\r\n     */\r\n    namespace.WebSocketConnection.prototype.send = function(data) {\r\n        if (typeof data !== \"undefined\") {\r\n            this.connection.send(data);\r\n        }\r\n    };\r\n    \r\n"],[0,"    // p"]],"start1":923,"start2":923,"length1":16,"length2":1417}]],"length":2466,"saved":false}
{"ts":1361914756610,"patch":[[{"diffs":[[0,"Message();\r\n"],[1,"        this.setOnError();\r\n"],[0,"    };\r\n    "]],"start1":1786,"start2":1786,"length1":24,"length2":52},{"diffs":[[0," {\r\n"],[-1,"        this.connection.disconnected;\r\n"],[0,"    "]],"start1":1998,"start2":1998,"length1":47,"length2":8},{"diffs":[[0,"defined\""],[1," && this.connection"],[0,") {\r\n   "]],"start1":2242,"start2":2242,"length1":16,"length2":35}]],"length":2474,"saved":false}
{"ts":1361914807994,"patch":[[{"diffs":[[0,"SocketConnection"],[1,"IO"],[0,".prototype.close"]],"start1":1953,"start2":1953,"length1":32,"length2":34},{"diffs":[[0,"nction() {\r\n"],[1,"        this.connection.close();\r\n"],[0,"    };\r\n    "]],"start1":1992,"start2":1992,"length1":24,"length2":58},{"diffs":[[0,"nnection"],[1,"IO"],[0,".prototy"]],"start1":2203,"start2":2203,"length1":16,"length2":18}]],"length":2512,"saved":false}
{"ts":1361915185622,"patch":[[{"diffs":[[0,"  };\r\n    \r\n"],[1,"    /**\r\n     * Set a function to execute when a connection is open.\r\n     * \r\n     * @param functionToCall Function link to the 'onopen' event.\r\n     * @return\r\n     */\r\n    namespace.WebSocketConnectionIO.prototype.setOnOpen = function(functionToCall) {\r\n        // set a default case\r\n        if (typeof functionToCall !== \"undefined\") {\r\n            this.onOpenFunction = functionToCall;  \r\n        } else if (this.onOpenFunction === null) {\r\n            this.onOpenFunction = function(e) { alert('Open socket: ' + e.data); };\r\n        }\r\n        \r\n        var self = this;\r\n        this.connection.on('connect', self.onOpenFunction);\r\n    };\r\n    \r\n    /**\r\n     * Set a function to execute when a connection is close.\r\n     * \r\n     * @param functionToCall Function link to the 'onclose' event.\r\n     * @return \r\n     */\r\n    namespace.WebSocketConnectionIO.prototype.setOnClose = function(functionToCall) {\r\n        // set a default case\r\n        if (typeof functionToCall !== \"undefined\") {\r\n            this.onCloseFunction = functionToCall;  \r\n        } else if (this.onCloseFunction === null) {\r\n            this.onCloseFunction = function(e) { alert('Close socket: ' + e.data); };\r\n        }\r\n        \r\n        var self = this;\r\n        this.connection.on('disconnect', self.onCloseFunction);\r\n    };\r\n    \r\n    /**\r\n     * Set a function to execute when we receive a message.\r\n     * \r\n     * @param functionToCall Function link to the 'onmessage' event.\r\n     * @return \r\n     */\r\n    namespace.WebSocketConnectionIO.prototype.setOnMessage = function(functionToCall) {\r\n        // set a default case\r\n        if (typeof functionToCall !== \"undefined\") {\r\n            this.onMessageFunction = functionToCall;  \r\n        } else if (this.onMessageFunction === null) {\r\n            this.onMessageFunction = function(e) { alert('Message: ' + e.data); };\r\n        }\r\n        \r\n        var self = this;\r\n        this.connection.on('message', self.onMessageFunction);\r\n    };\r\n    \r\n    /**\r\n     * Set a function to execute when an error happen.\r\n     * \r\n     * @param functionToCall Function link to the 'onerror' event.\r\n     * @return \r\n     */\r\n    namespace.WebSocketConnection.prototype.setOnError = function(functionToCall) {\r\n        // set a default case\r\n        if (typeof functionToCall !== \"undefined\") {\r\n            this.onErrorFunction = functionToCall;  \r\n        } else if (this.onErrorFunction === null) {\r\n            this.onErrorFunction = function(e) { alert('Error: ' + e.data); };\r\n        }\r\n        \r\n        var self = this;\r\n        this.connection.on('error', self.onErrorFunction);\r\n    };\r\n    \r\n"],[0,"    // priva"]],"start1":2366,"start2":2366,"length1":24,"length2":2659}]],"length":5147,"saved":false}
{"ts":1361915216536,"patch":[[{"diffs":[[0,"nnection"],[1,"IO"],[0,".prototy"]],"start1":4560,"start2":4560,"length1":16,"length2":18}]],"length":5149,"saved":false}
{"ts":1361915299295,"patch":[[{"diffs":[[0,"unction("],[-1,"url"],[0,") {\r\n   "]],"start1":1550,"start2":1550,"length1":19,"length2":16}]],"length":5146,"saved":false}
{"ts":1361915313743,"patch":[[{"diffs":[[0,"aram"],[-1," url Url of the server to connect to."],[0,"\r\n  "]],"start1":1428,"start2":1428,"length1":45,"length2":8}]],"length":5109,"saved":false}
{"ts":1361915728555,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"        var self = this;\r\n"],[0,"    "]],"start1":2887,"start2":2887,"length1":34,"length2":8},{"diffs":[[0,"nnect', "],[-1,"self"],[1,"this"],[0,".onOpenF"]],"start1":2921,"start2":2921,"length1":20,"length2":20}]],"length":5083,"saved":false}
{"ts":1361915892648,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        this.connection.close();\r\n"],[0,"    "]],"start1":1960,"start2":1960,"length1":42,"length2":8}]],"length":5049,"saved":false}
{"ts":1361915956644,"patch":[[{"diffs":[[0," this.connection"],[1," !== null"],[0,") {\r\n           "]],"start1":2217,"start2":2217,"length1":32,"length2":41}]],"length":5058,"saved":false}
{"ts":1361916477005,"patch":[[{"diffs":[[0,"'connect"],[1,"ion"],[0,"', this."]],"start1":2893,"start2":2893,"length1":16,"length2":19}]],"length":5061,"saved":false}
{"ts":1361916621870,"patch":[[{"diffs":[[0,"'connect"],[-1,"ion"],[0,"', this."]],"start1":2893,"start2":2893,"length1":19,"length2":16}]],"length":5058,"saved":false}
{"ts":1361916676107,"patch":[[{"diffs":[[0,"se}); \r\n"],[1,"            this.connection.connect();\r\n"],[0,"        "]],"start1":1644,"start2":1644,"length1":16,"length2":56}]],"length":5098,"saved":false}
{"ts":1361917043181,"patch":[[{"diffs":[[0,"nection."],[1,"socket."],[0,"connect("]],"start1":1672,"start2":1672,"length1":16,"length2":23}]],"length":5105,"saved":false}
{"ts":1361917446112,"patch":[[{"diffs":[[0,"    "],[-1,"this.connection.socket.connect();\r\n        }\r\n        \r\n"],[1,"\r\n    "],[0,"    "]],"start1":1660,"start2":1660,"length1":64,"length2":14},{"diffs":[[0,"pen();\r\n        "],[1," "],[1,"   "],[0,"this.setOnClose("]],"start1":1689,"start2":1689,"length1":32,"length2":36},{"diffs":[[0,"OnClose();\r\n"],[1,"    "],[0,"        this"]],"start1":1717,"start2":1717,"length1":24,"length2":28},{"diffs":[[0,"age();\r\n        "],[1," "],[1,"   "],[0,"this.setOnError("]],"start1":1755,"start2":1755,"length1":32,"length2":36},{"diffs":[[0,"OnError();\r\n"],[1,"            \r\n            this.connection.socket.connect();\r\n        }\r\n"],[0,"    };\r\n    "]],"start1":1783,"start2":1783,"length1":24,"length2":96}]],"length":5139,"saved":false}
{"ts":1361917510098,"patch":[[{"diffs":[[0,"ion !== null"],[1," && this.connection.socket.connected"],[0,") {\r\n       "]],"start1":2311,"start2":2311,"length1":24,"length2":60}]],"length":5175,"saved":false}
{"ts":1361917930970,"patch":[[{"diffs":[[0,"tion = function("],[-1,"e"],[1,"data"],[0,") { alert('Open "]],"start1":2904,"start2":2904,"length1":33,"length2":36},{"diffs":[[0,"pen socket: ' + "],[-1,"e."],[0,"data); };\r\n     "]],"start1":2936,"start2":2936,"length1":34,"length2":32},{"diffs":[[0,"tion = function("],[-1,"e"],[1,"data"],[0,") { alert('Close"]],"start1":3540,"start2":3540,"length1":33,"length2":36},{"diffs":[[0,"socket: ' + "],[-1,"e."],[0,"data); };\r\n "]],"start1":3577,"start2":3577,"length1":26,"length2":24},{"diffs":[[0,"    "],[-1,"    "],[-1,"\r\n        var self = this;"],[0,"\r\n  "]],"start1":3611,"start2":3611,"length1":38,"length2":8},{"diffs":[[0,"nnect', "],[-1,"self"],[1,"this"],[0,".onClose"]],"start1":3650,"start2":3650,"length1":20,"length2":20},{"diffs":[[0,"tion = function("],[-1,"e"],[1,"data"],[0,") { alert('Messa"]],"start1":4186,"start2":4186,"length1":33,"length2":36},{"diffs":[[0,"essage: ' + "],[-1,"e."],[0,"data); };\r\n "]],"start1":4218,"start2":4218,"length1":26,"length2":24},{"diffs":[[0,"  \r\n"],[-1,"        var self = this;\r\n"],[0,"    "]],"start1":4258,"start2":4258,"length1":34,"length2":8},{"diffs":[[0,"ssage', "],[-1,"self"],[1,"this"],[0,".onMessa"]],"start1":4292,"start2":4292,"length1":20,"length2":20},{"diffs":[[0,"unction("],[-1,"e"],[1,"data"],[0,") { aler"]],"start1":4823,"start2":4823,"length1":17,"length2":20},{"diffs":[[0,"or: ' + "],[-1,"e."],[0,"data); }"]],"start1":4849,"start2":4849,"length1":18,"length2":16},{"diffs":[[0,"  \r\n"],[-1,"        var self = this;\r\n"],[0,"    "]],"start1":4885,"start2":4885,"length1":34,"length2":8},{"diffs":[[0,"r', "],[-1,"self"],[1,"this"],[0,".onE"]],"start1":4921,"start2":4921,"length1":12,"length2":12}]],"length":5097,"saved":false}
{"ts":1361918346989,"patch":[[{"diffs":[[0,"nction() {\r\n"],[1,"        this.connection.socket.disconnect();\r\n"],[0,"    };\r\n    "]],"start1":2033,"start2":2033,"length1":24,"length2":70}]],"length":5143,"saved":false}
{"ts":1361918714054,"patch":[[{"diffs":[[0,"nection."],[1,"socket."],[0,"disconne"]],"start1":1254,"start2":1254,"length1":16,"length2":23}]],"length":5150,"saved":false}
{"ts":1361918980297,"patch":[[{"diffs":[[0," {\r\n"],[-1,"        if (this.connection === null) {\r\n    "],[0,"    "]],"start1":1529,"start2":1529,"length1":53,"length2":8},{"diffs":[[0,"      \r\n        "],[-1,"    "],[0,"this.setOnOpen()"]],"start1":1620,"start2":1620,"length1":36,"length2":32},{"diffs":[[0,"pen();\r\n        "],[-1,"  "],[-1,"  "],[0,"this.setOnClose("]],"start1":1647,"start2":1647,"length1":36,"length2":32},{"diffs":[[0,"OnClose();\r\n"],[-1,"    "],[0,"        this"]],"start1":1671,"start2":1671,"length1":28,"length2":24},{"diffs":[[0,");\r\n        "],[-1,"    "],[0,"this.setOnEr"]],"start1":1709,"start2":1709,"length1":28,"length2":24},{"diffs":[[0,"      \r\n        "],[-1," "],[-1,"   "],[0,"this.connection."]],"start1":1747,"start2":1747,"length1":36,"length2":32},{"diffs":[[0,"connect();\r\n"],[-1,"        }\r\n"],[0,"    };\r\n    "]],"start1":1786,"start2":1786,"length1":35,"length2":24}]],"length":5074,"saved":false}
{"ts":1361919100559,"patch":[[{"diffs":[[0,"tion"],[-1,") {\r\n            return false;\r\n        } else if ("],[1," || "],[0,"this"]],"start1":1191,"start2":1191,"length1":59,"length2":12}]],"length":5027,"saved":false}
{"ts":1361919459087,"patch":[[{"diffs":[[0,"tion || "],[1,"!"],[0,"this.con"]],"start1":1191,"start2":1191,"length1":16,"length2":17},{"diffs":[[0,"tion.socket."],[-1,"dis"],[0,"connected) {"]],"start1":1211,"start2":1211,"length1":27,"length2":24}]],"length":5025,"saved":false}
{"ts":1361919814452,"patch":[[{"diffs":[[0,"= function() {\r\n"],[1,"        if (!this.connection) {\r\n    "],[0,"        this.con"]],"start1":1468,"start2":1468,"length1":32,"length2":69},{"diffs":[[0,"se}); \r\n"],[1,"            this.connection.socket.connect();\r\n        } else {\r\n            this.connection.socket.reconnect();\r\n        }\r\n"],[0,"        "]],"start1":1594,"start2":1594,"length1":16,"length2":141},{"diffs":[[0,"Message();\r\n"],[1,""],[0,"        this"]],"start1":1814,"start2":1814,"length1":24,"length2":24},{"diffs":[[0,");\r\n"],[-1,"            \r\n        this.connection.socket.connect();\r\n"],[0,"    "]],"start1":1850,"start2":1850,"length1":65,"length2":8}]],"length":5130,"saved":false}
{"ts":1361919972252,"patch":[[{"diffs":[[0,"  } "],[-1,"else {\r\n            this.connection.socket.reconnect();\r\n        }"],[0,"\r\n  "]],"start1":1655,"start2":1655,"length1":74,"length2":8}]],"length":5064,"saved":false}
{"ts":1361920148432,"patch":[[{"diffs":[[0,"      } "],[1,"else {\r\n            this.connection.socket.reconnect();\r\n        }"],[0,"\r\n      "]],"start1":1651,"start2":1651,"length1":16,"length2":82}]],"length":5130,"saved":false}
{"ts":1361920222586,"patch":[[{"diffs":[[0,"OpenFunction);\r\n"],[1,"        this.connection.on('reconnect', function() { alert('reconnecting...')});\r\n"],[0,"    };\r\n    \r\n  "]],"start1":3062,"start2":3062,"length1":32,"length2":114}]],"length":5212,"saved":false}
